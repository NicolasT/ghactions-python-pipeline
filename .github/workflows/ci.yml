---
name: CI

on:
  - push
  - pull_request

permissions:
  contents: read

jobs:
  package-sdist:
    runs-on: "ubuntu-latest"
    steps:
      - name: Placeholder
        run: true

  package-srpm:
    runs-on: "ubuntu-latest"
    needs:
      - package-sdist
    steps: []

  package-centos7-rpm:
    runs-on: "ubuntu-latest"
    needs:
      - package-srpm
    steps: []

  package-centos8-rpm:
    runs-on: "ubuntu-latest"
    needs:
      - package-srpm
    steps: []

  package-fedora-rpm:
    runs-on: "ubuntu-latest"
    needs:
      - package-srpm
    steps: []

  test:
    runs-on: "ubuntu-latest"
    steps:
      - name: Placeholder
        run: true

  e2e:
    runs-on: "ubuntu-latest"
    strategy:
      fail-fast: false
      matrix:
        include:
          - source-job: package-sdist
            target: e2e-sdist
          - source-job: package-centos7-rpm
            target: e2e-centos7
          - source-job: package-centos8-rpm
            target: e2e-centos8
          - source-job: package-fedora-rpm
            target: e2e-fedora
    needs:
      - ${{ matrix.source-job }}
    steps:
      - name: Placeholdder
        run: echo ${{ matrix.target }}

  release:
    runs-on: "ubuntu-latest"
    needs:
      - package-sdist
      - package-srpm
      - package-centos7-rpm
      - package-centos8-rpm
      - package-fedora-rpm
      - test
      - e2e
    steps:
      - name: Placeholder
        run: true
